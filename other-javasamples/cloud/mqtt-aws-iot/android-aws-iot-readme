

2023-10-1



search aws iot android client


https://repost.aws/questions/QUtOYDbZWESRyCK1Y1xmuW4A/aws-iot-core-for-android-devices

    it's more common for mobile apps to use Cognito identities than X.509 certificates. 
    and to use mobile sdk or amplify to publish and subscripbe to aws iot core.

    links: 
      cognito identities 
      https://docs.aws.amazon.com/iot/latest/developerguide/cognito-identities.html

      mobile sdk
      https://docs.amplify.aws/sdk/pubsub/getting-started/q/platform/android/

      amplify
      https://docs.amplify.aws/lib/pubsub/getting-started/q/platform/js/



aws iot service console start package: 

  connect one device from aws console, and choose linux, java. 
  the start.sh contains: 

    package: aws-iot-device-sdk-java-v2
    include: software.amazon.awssdk.crt*

    command line: 
        mvn exec:java -pl samples/BasicPubSub \
                -Dexec.mainClass=pubsub.PubSub \
                -Dexec.args='--endpoint abcd1234-ats.iot.us-east-2.amazonaws.com --client_id sdk-java --topic sdk/test/java --ca_file ../root-CA.crt --cert ../MyIotThing.cert.pem --key ../MyIotThing.private.key'



github aws/aws-iot-device-sdk-java-v2

  search issues: android studio
    issue 87: how to build crt
      build for "Failed to resolve: software.amazon.awssdk.crtandroid:0.6.5"

        git clone git@github.com/awslabs/aws-crt-java
        cd aws-crt-java
        git checkout v0.6.5
        cd android
        ./gradlew build
        ./gradlew publishToMavenLocal

        ls -R .m2/repository/software/amazon/awssdk/crt

  build and publish the sdk to maven local. modify its gradle.build to work-around some bugs.
  build the sample app, it builds ok.

    if we don't build and publish sdk to maven local, the sample won't build. 
    though we can find the sdk here: 
        https://central.sonatype.com/artifact/software.amazon.awssdk.iotdevicesdk/aws-iot-device-sdk?smo=true
        https://repo1.maven.org/maven2/software/amazon/awssdk/iotdevicesdk/aws-iot-device-sdk/1.17.0/

  removed the project directory, and re-did it again. the sample app builds without building sdk first.

    speculation: previously attempted to build the sdk first, and it failed. the failure might have 
                 left some damaged/temporary files in the ide. that might have caused the sample app
                 build to fail.
                 another possibility could be that the local build has left the library installed 
                 at ~/.m2/... location.

  the android sample app has a bug in its build.gradle in sample paths, missing a slash in all samples.

  from issue 346

    https://mvnrepository.com/artifact/software.amazon.awssdk.crt/aws-crt-android
    https://docs.gradle.org/current/userguide/dependency_downgrade_and_exclude.html#sec:excluding-transitive-deps

  used aws libraries: from the android studio it can be seen 
        gradle: software.amazon.awssdk.crt:aws-crt-android:0.27.3@aar
        gradle: software.amazon.awssdk.iotdevicesdk:aws-iot-device-sdk-android:1.17.0@aar

  search online for where the android studio keeps dependencies, two locations:
        one that the ~/.gradle/caches/modules-2/file2-2.1/, where we can find the aws-crt-android-0.27.3.aar .
        another at ~/.m2/repository/... where we can find the aws-iot-device-sdk-android-1.17.0.aar .


